<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
    <style>
      body {
        background-color: black;
        color: white; /* Metin rengi eklendi */
        font-family: Arial;
        padding: 20px;
      }
      #chatBox {
        height: 300px;
        overflow-y: auto;
        border: 1px solid #ccc;
        padding: 10px;
        margin: 10px 0;
      }
    </style>
  </head>
  <body>
    <h2>AnoChat</h2>
    <div id="chatBox"></div>

    <script>
      const SUPABASE_URL = 'https://rtgfyzaznstvtudxzqvr.supabase.co';
      const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJ0Z2Z5emF6bnN0dnR1ZHh6cXZyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDQzODQ4NjgsImV4cCI6MjA1OTk2MDg2OH0.3pvOc252sqY5SOc2IXEM8XO7E403cc0UEDI-XtjV61M';
      const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY);
      
      // ChatBox elementini seç
      const chatBox = document.getElementById('chatBox');

      async function fetchMessages() {
        try {
          const { data, error } = await supabase
            .from('messages')
            .select('*')
            .order('created_at', { ascending: true });

          if (error) throw error;
          
          chatBox.innerHTML = '';
          data.forEach(msg => appendMessage(msg));
          
        } catch (err) {
          chatBox.innerHTML = `Hata: ${err.message}`;
        }
      }

      function appendMessage(msg) {
        const div = document.createElement('div');
        div.textContent = `${msg.user_name}: ${msg.content}`;
        div.style.margin = "5px 0"; // Mesaj aralıkları
        chatBox.appendChild(div);
        chatBox.scrollTop = chatBox.scrollHeight; // Otomatik scroll
      }

      // DOM yüklendikten sonra çalıştır
      document.addEventListener('DOMContentLoaded', fetchMessages);
    </script>
  </body>
</html>
